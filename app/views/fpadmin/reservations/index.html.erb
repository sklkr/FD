<div class="main-header clearfix">
    <div class="page-title">
        <h3 class="no-margin">Reservations</h3>
        <span></span>
    </div><!-- /page-title -->
    
    <ul class="page-stats">
        <a href="?history=true" class="btn btn-primary">History</a>
    </ul><!-- /page-stats -->
</div>


<div class="padding-md">
    <% if params['history'].blank? %>
        <div class="panel panel-default table-responsive">
            <div class="panel-heading">
                <span>Reservations</span>
                <span class="pull-right">
                    <%= paginate @reservations %>
                </span>
            </div>
            <table class="table table-striped table-responsive" id="responsiveTable">
                <thead>
                    <tr>
                        <th>Customer</th>
                        <th>Mobile</th>
                        <th>Class Name</th>
                        <th>Center Name</th>
                        <th>Date</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <% @reservations.each do |r| %>
                        <tr>
                            <td><%= r.customer.try(:full_name) %></td>
                            <td><%= r.customer.try(:phone) %></td>
                            <td><%= r.fpclass.name %></td>
                            <td><a href="mailto:<%= r.customer.try(:email) %>"><%= r.center.name %></a></td>
                            <td><%= "#{r.expired_at} #{r.fpclass.start_time.strftime("%H:%M") unless r.fpclass.blank?}" %></td>
                            <td></td>
                        </tr>
                    <%end%>
                </tbody>
            </table>
            <div class="panel-footer clearfix">
                <span class="pull-right">
                    <%= paginate @reservations %>
                </span>
            </div>
        </div>
    <% end %>

    <% unless params['history'].blank? %>
        <div class="panel panel-default table-responsive">
            <div class="panel-heading">
                <span>Reservations</span>
                <span class="pull-right">
                    <%= paginate @history %>
                </span>
            </div>
            <table class="table table-striped table-responsive" id="responsiveTable">
                <thead>
                    <tr>
                        <th>Customer</th>
                        <th>Mobile</th>
                        <th>Class Name</th>
                        <th>Center Name</th>
                        <th>Date</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <% @history.each do |r| %>
                        <tr>
                            <td><%= r.customer.try(:full_name) %></td>
                            <td><%= r.customer.try(:phone) %></td>
                            <td><%= r.fpclass.name %></td>
                            <td><a href="mailto:<%= r.customer.try(:email) %>"><%= r.center.name %></a></td>
                            <td><%= "#{r.expired_at} #{r.fpclass.start_time.strftime("%H:%M") unless r.fpclass.blank?}" %></td>
                            <td></td>
                        </tr>
                    <%end%>
                </tbody>
            </table>
            <div class="panel-footer clearfix">
                <span class="pull-right">
                    <%= paginate @history %>
                </span>
            </div>
        </div>
    <% end %>
</div>